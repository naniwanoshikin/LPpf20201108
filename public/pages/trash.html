<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charaset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ロジックワールド</title>
  <meta name="description" content="SHIKITTI WORLD">
  <!-- ファビコン -->
  <link rel="icon" href="../src/img/nezcon.ico">
  <!-- CSS -->
  <link rel="stylesheet" href="../src/css/trash.css">
  <!-- jQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <!-- Bootstrap CSS  体裁崩れあり-->
  <!-- Bootstrap付けるとなぜか①アニメーションが効かなくなった。②CSSのfontsizeとかもデフォルト？になったりした。→Linkタグの位置をCSS読み込みより先に書けばいい？？？ -->
  <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous"> -->
  <!-- scroll Reveall -->
  <script src="https://unpkg.com/scrollreveal"></script>
  <!-- font-awesome CDN-->
  <link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
  <!-- font-awesome-animation -->
  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome-animation/0.0.10/font-awesome-animation.css"
    type="text/css" media="all" />
  <!-- material font -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!-- ハートマーク -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!-- chart.jsのCDN読み込み -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js">
  </script>
  <!-- react本体 -->
  <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
  <!-- reactの結果をDOMに反映するライブラリ -->
  <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
  <!-- JSXを使うためのBabelライブラリ -->
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
</head>
<!-- ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ -->

<body>
  <header>
    <div class="domtree">
      <h1 id="target" data-translation="shikiti World">DOM</h1>
    </div>
    <div class="pcmenu">
      <nav>
        <ul>
          <li><a href="#medias">MEDIA</a></li>
          <li><a href="#touch">TOUCH</a></li>
          <li><a href="#todos">TODO</a></li>
          <li><a href="#counts">COUNT</a></li>
          <li><a href="../">BACK</a></li>
        </ul>
      </nav>
    </div>
    <div class="spmenu">
      <span class="material-icons" id="open">widgets</span>
    </div>
    <!-- スマホ用メニュー画面 -->
    <div class="overlay">
      <span class="material-icons" id="close">wc</span>
      <nav>
        <ul>
          <li><a href="#medias">MEDIA</a></li>
          <li><a href="#todos">TODO</a></li>
          <li><a href="#lists">LIST</a></li>
          <li><a href="#counts">COUNT</a></li>
          <li><a href="../">BACK</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main>

    <!-- メディア ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ -->
    <section id="medias">
      <h2>Medias</h2>
      <div class="media">
        <div class="image">pink</div>
        <div class="text">Text</div>
        <!-- 広告 -->
        <aside>ad</aside>
      </div>
    </section>

    <!-- クイズ ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ -->
    <section class="quizs">
      <h2>VisionTest</h2>
      <div class="quiz">
        <p>正しいものを選べ。</p>
        <p id="vtest">
          <!-- 画像 -->
        </p>
        <!-- <p id="question"></p> -->
        <!-- 選択肢 -->
        <ul id="choices">
          <!-- li -->
        </ul>
        <div id="nextbtn" class="disabled">Next</div>
        <!-- スコア結果 -->
        <section id="result" class="hidden">
          <p>
            <!-- Score: 2 / 3 -->
          </p>
          <img src="../src/img/aich4.JPG" width=100%>
          <a href="">Reply?</a>
        </section>
      </div>
    </section>

    <!-- BOX ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ -->
    <section id="boxes">
      <h2>Box</h2>
      <div class="boxanm box">
        <!-- CSSanimation -->
      </div>
      <div id="round">
        <!-- JS -->
      </div>
    </section>

    <!-- タッチゲーム＝＝＝＝＝＝＝＝＝＝＝＝ -->
    <section>
      <h2>Touch</h2>
      <div id="touch">
        <div id="time">0.0</div>
        <ul id="board">
          <!-- クラス -->
        </ul>
        <div id="touchbtn">start</div>
      </div>
    </section>

    <!-- タブメニュー ＝＝＝＝＝＝＝＝＝＝＝＝＝ -->
    <div class="tabs">
      <h2>Tab</h2>
      <ul class="menu">
        <li><a href="#" class="active" data-id="about">概要</a></li>
        <li><a href="#" data-id="service">内容</a></li>
        <li><a href="#" data-id="contact">お問い合わせ</a></li>
      </ul>
      <!-- idはitemとcontactを紐付ける役割 -->
      <section class="content active" id="about">
        こんにちはこんにちはこんにちはこんにちはこんにちはこんにちはこんにちはこんにちはこんにちはこんにちはこんにちはこんにちはこんにちはこんにちは
      </section>
      <section class="content" id="service">
        内容おおおおおおおおお内容おおおおおおおおお内容おおおおおおおおお内容おおおおおおおおお内容おおおおおおおおお内容おおおおおおおおお内容おおおおおおおおお内容おおおおおおおおお
      </section>
      <section class="content" id="contact">
        お問い合わせええええええええお問い合わせええええええええお問い合わせええええええええお問い合わせええええええええお問い合わせええええええええお問い合わせええええええええお問い合わせええええええええ
      </section>
    </div>

    <!-- スロットマシーン ＝＝＝＝＝＝＝＝＝＝＝＝ -->
    <section class="slots">
      <h2 id="slot">Slot: <span id="points">0点 0回 確率 11.1%</span></h2>
      <div class="mainslot">
        <!-- Panelクラス -->
      </div>
      <div id="spin">SPINNNNN</div>
    </section>

    <!-- TODOリスト ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ -->
    <section>
      <h2 id="todos">TODOs</h2>
      <div class="todos">
        <!-- React.js -->
        <div id="root1"></div>
      </div>
    </section>

    <!-- カウントアップ＝＝＝＝＝＝＝＝＝＝＝＝＝ -->
    <section id="counts">
      <h2>COUNTs</h2>
      <div class="timer">
        <h3>Timer</h3>
        <div id="timer">00:00.000</div>
        <div class="btns">
          <div class="btn" id="start">Start</div>
          <div class="btn" id="stop">Stop</div>
          <div class="btn" id="reset">Reset</div>
        </div>
      </div>
      <!-- React.js -->
      <div id="root2"></div>
    </section>

    <!-- サイコロ React.js ＝＝＝＝＝＝＝＝ -->
    <section class="mt-5">
      <h2>サイコロ</h2>
      <div id="display" class="text-center">
        <p>0</p>
      </div>
      <div class="text-center">
        <button class="btn btn-primary" onclick="refresh()">PUSH</button>
      </div>
    </section>

  </main>

  <footer>
    <p>END</p>
  </footer>

  <!-- JSXなし-->
  <script>
    let dom = document.getElementById('display'); //
    let refresh = () => {
      let num = Math.floor(Math.random() * 6) + 1;
      let el = React.createElement( // Reactのプログラム（<p>, 属性, 値）
        'p', {}, num
      )
      ReactDOM.render(el, dom); // レンダリング（表示）する。
    }
  </script>

  <!-- クイズ -->
  <script src="../src/js/trash/quiz.js"></script>
  <!-- 数字タッチゲーム -->
  <script src="../src/js/trash/touch.js"></script>
  <!-- ボックス -->
  <script src="../src/js/trash/boxtouch.js"></script>
  <!-- タブ -->
  <script src="../src/js/trash/tab.js"></script>
  <!-- ストップウオッチ -->
  <script src="../src/js/trash/timer.js"></script>
  <!-- スロット -->
  <script src="../src/js/trash/slot.js"></script>
  <!-- メニュー -->
  <script src="../src/js/trash/menu.js"></script>

  <!-- ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ -->
  <!-- React babel 読み込み -->
  <script type="text/babel">
    (() => { // 即時関数

      // Todoアプリ
      // li要素の中身
      const todos = [
        { id: 0, title: 'Task 0', isDone: false },
        { id: 1, title: 'Task 1', isDone: false },
        { id: 2, title: 'Task 2', isDone: true },
      ];

      // // タイトル + パージ部のコンポーネント
      // function TodoHeader(props) {
      //   // 未完了のli要素
      //   const remaining = props.todos.filter(todo => {
      //     return !todo.isDone;
      //   });
      //   return ( // 削除機能だからpurgeがとる引数はないってこと？？
      //     <h3>
      //       <button
      //         onClick={() => props.purge()}
      //       >Purge</button>
      //       Todos
      //       <span>(
      //         {remaining.length}/{props.todos.length}
      //       )</span>
      //     </h3>
      //   );
      // }
      // li コンポーネント（拡張しやすいよう）
      const TodoItem = (props) => {
        return (
          <li>
            <label>
              <input type="checkbox"
                checked={props.todo.isDone}
                // check管理用: 親クラスのstateを変更する為、親へ処理をゆずっていく。
                onChange={() => props.checkTodo(props.todo)}
              />
              <span className={props.todo.isDone ? 'done' : ''}>
                {props.todo.title}
              </span>
              <span className="cmd" // 削除ボタン
              // onClick={() => props.deleteTodo(props.todo)}
              >[x]
              </span>
            </label>
          </li>
        );
      }
      // ul コンポーネント
      const TodoList = (props) => {
        const todos = props.todos.map(aaa => { // propsを1つ1つ処理
          return (
            <TodoItem
              key={aaa.id}
              todo={aaa} // ★propsのtodo属性として子へ。
              checkTodo={props.checkTodo} // checkbox用 親へ。
            // deleteTodo={props.deleteTodo} // 親へ。
            />
          );
        });
        return (
          <ul>
            {props.todos.length ? todos : <li> Nothing to do</li>}
          </ul>
        );
      }
      // 入力欄の本文
      // function TodoForm(props) {
      //   return (
      //     <form onSubmit={props.addTodo} >
      //       <input type="text" value={props.item}
      //         // UIの変更はsetStateでのみ行う→onChangeを設定
      //         onChange={props.updateItem}
      //       />
      //       <input type="submit" value="Add" />
      //     </form>
      //   );
      // }
      // li要素のランダムなid
      // function getUniqueId() { // 現在時刻-乱数 36進数
      //   return new Date().getTime().toString(36) + '-' + Math.random().toString(36);
      // }

      // ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝
      // ここでデータを一元管理する
      class Todo extends React.Component {
        constructor() {
          super();
          this.state = {
            todos: todos,
            // item: '', // テキスト入力
          };
          // 何のためにここ書いている？？
          // state使う時にかく。各メソッドに渡す。
          this.checkTodo = this.checkTodo.bind(this);
          // this.deleteTodo = this.deleteTodo.bind(this);
          // this.updateItem = this.updateItem.bind(this);
          // this.addTodo = this.addTodo.bind(this);
          // this.purge = this.purge.bind(this);
        }

        // メソッド：this.state.todos.から始まる。
        // purge() {
        //   if (!confirm('are you sure?')) {
        //     return;
        //   }
        //   const todos = this.state.todos.filter(todo => {
        //     return !todo.isDone; // チェックしていない要素だけをli要素にする
        //   });
        //   this.setState({
        //     todos: todos
        //   });
        // }
        // チェックON/OFF管理
        checkTodo(atodo) { // onChangeできたtodoをindexOfのtodoに渡す。
          // todosのコピーを作る。→stateを変更。
          const todos = this.state.todos.map(aaa => {
            return { id: aaa.id, title: aaa.title, isDone: aaa.isDone };
          });
          // 変更したいisDoneのid番号
          const pos = this.state.todos.map(bbb => {
            return bbb.id; // idプロパティの配列の
          }).indexOf(atodo.id); // チェックした番号。
          // そのチェックを反転。
          todos[pos].isDone = !todos[pos].isDone;
          this.setState({
            todos: todos // 値を変更
          });
        }
        // テキスト入力値を管理
        // updateItem(e) { // formの値はeオブジェクトから取得。
        //   this.setState({
        //     item: e.target.value
        //   });
        // }
        // リスト追加
        // addTodo(e) {
        //   e.preventDefault(); // 画面遷移を防ぐ
        //   if (this.state.item.trim() === '') {
        //     return;
        //   }
        //   const item = { // 新しく追加したいtodosオブジェクト
        //     id: getUniqueId(), // ユニークなid
        //     title: this.state.item, // テキスト名
        //     isDone: false,
        //   };
        //   // 上記を既存のtodosに追加したいので、todosのコピーを作る。
        //   const todos = this.state.todos.slice(); // 新しい文字列
        //   todos.push(item); // todosに対して上記itemを追加
        //   this.setState({
        //     todos: todos,
        //     item: '', // 空文字をセット
        //   });
        // }
        // 削除
        // deleteTodo(todo) {
        //   // if (!confirm('are you sure?')) {
        //   //   return;
        //   // }
        //   // オブジェクトのプロパティ（id, title, isDone）はいじらないのでslice
        //   const todos = this.state.todos.slice(); // 文字列
        //   const pos = this.state.todos.indexOf(todo); // 選択したインデックス
        //   todos.splice(pos, 1); // 1つ目の要素を削除。
        //   this.setState({
        //     todos: todos
        //   });
        // }
        // Local Strage
        // コンポーネントが更新される際に、ブラウザに保存。
        // componentDidUpdate() { // setItem(key, Value(JSON形式))
        //   localStorage.setItem('todos', JSON.stringify(this.state.todos));
        // }
        // コンポーネントがマウントされる際に、ブラウザのデータを読み込む。
        // todosの中身をLocalStorageの中身にしたい。上手くいかなければ空配列。
        // componentDidMount() {
        //   this.setState({ // todosの中身をLocalStorageの中身にしたい
        //     todos: JSON.parse(localStorage.getItem('todos')) || [] // もしくは空配列にしてあげる。
        //   });
        // }
        // <TodoHeader // Todos(1/3)
        //         todos={this.state.todos} // (1/3) （子へ）
        //         purge={this.purge} // 一斉削除
        //       />
        //       <TodoForm
        //         item={this.state.item} // テキスト入力
        //         updateItem={this.updateItem} // 入力値管理
        //         addTodo={this.addTodo} // 追加
        //       />
        render() {
          return (
            // 各コンポーネントを作成
            <div className="todo">
              <TodoList
                // リスト内の各属性
                todos={this.state.todos} // id, title, idDone
                checkTodo={this.checkTodo} // チェック管理メソッド（子より）
              // deleteTodo={this.deleteTodo} // 削除メソッド（子より）
              />
            </div>
          );
        }
      }

      ReactDOM.render( // JS内
        <Todo />, // コンポーネントクラス
        document.getElementById('root1')
      );
      //＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ -->
      //＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝ -->
      // カウントアップ機能
      // li要素の中身（CounterListの子のコンポーネント）
      function Counter(props) { // ④ここにcountUp関数をcountUpプロパティとして渡す
        return (  // ★ ①クリックした時に、props.countUpを実行する。⑤このonClickでprops.countUpで渡されてきたcountUp関数を使用し、その引数にほぼ同様の流れで親から渡されてきたprops.counterを入れて、countUp関数を動作させている。
          <li style={{ backgroundColor: props.counter.color }} onClick={() => { props.countUp(props.counter) }}>
            {props.counter.id}:{props.counter.count}
          </li>
          // propsは読み取り専用の値である。class内ではthisを前につけてあげる。countがstateであるのに対し、colorがpropである。
        );
      }
      // ulリストの管理機能（Appクラスの子のコンポーネント）
      function CounterList(props) { // ③ここにcountUp関数をcountUpプロパティとして渡す。
        const counters = props.counters.map(counter => { // mapメソッド
          return (
            <Counter
              counter={counter}
              key={counter.id}  // ループ処理する要素にはkeyというユニークな要素をつけないと流れない
              countUp={props.countUp} // ★propsにcountUp属性をつける。CounterListを通してAppのcountUpがセットされている。
            />
          );
        });
        return (
          <ul>{counters}</ul>
        );
      }

      // Counterの情報をstateで管理
      class App extends React.Component {
        constructor() {
          super();
          this.state = {
            counters: [ // オブジェクト
              { id: '①', count: 0, color: 'tomato' },
              { id: '②', count: 0, color: 'skyblue' },
              { id: '③', count: 0, color: 'limegreen' },
              { id: '④', count: 0, color: 'yellow' },
            ],
            total: 0,
          };
          this.countUp = this.countUp.bind(this); // ★thisがundefinedとならない様に
        }

        // 押された時の動作機能
        countUp(counter) { // ②クラスのstateの中のcountを変更するためのcountUp関数はAppクラスでしか定義できないのでここでする。
          // setStateをすることで、1.stateを変更 2.その変更を検知して以前のstateと違いがあるチェック 3.差分があればcomponentを再描画する
          this.setState(prevState => { // setStateするたびにrender()が呼ばれ新しい値でUIが再描画される。
            // オブジェクト形式なのでmapを使う
            const counters = prevState.counters.map(counter => {
              return { id: counter.id, count: counter.count, color: counter.color }; // 直前のstateの値のcountersのコピーができる
            });
            // countを増やしたい要素の順番。
            const pos = counters.map(counter => { // ↑今作ったcountersの1つ１つの要素をcounterとしてmap処理。
              return counter.id; // counter.idが、
            }).indexOf(counter.id); // 何番目か調べる。

            counters[pos].count++; // countersのpos番目のcountを1増やす
            // ここで値をセット（プロパティの値を変更）
            return {
              counters: counters, // countersのキーで今書き換えたcountersを渡す
              total: prevState.total + 1
            };
          });
        }
        render() {
          const name = "クリック"; // →JSXの{}にJSで渡せる
          return (
            <div className="reactcount">
              <div>{this.state.total}{name.toUpperCase()}</div>
              <CounterList // コンポーネント
                // リストの値は別で管理
                counters={this.state.counters}
                countUp={this.countUp} // ★ stateの値（属性？）を変更できる
              />
            </div>
          );
        }
      }
      ReactDOM.render(
        <App />,
        document.getElementById('root2')
      );
      // ＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝

    })();
  </script>

</body>

</html>